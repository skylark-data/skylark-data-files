{"version":3,"sources":["providers/worker/worker-file.js"],"names":["define","PreloadFile","SpecialArgType","misc","[object Object]","_fs","_path","_flag","_stat","remoteFdId","contents","super","this","_remoteFdId","type","FD","id","data","bufferToTransferrableObject","getBuffer","stat","getStats","toBuffer","path","getPath","flag","getFlag","getFlagString","cb","_syncClose","isDirty","syncClose","e","resetDirty"],"mappings":";;;;;;;AAAAA,QACI,qBACA,qBACA,UACD,SAAUC,EAAYC,EAAeC,GAgDpC,qBA3CyBF,EACrBG,YAAYC,EAAKC,EAAOC,EAAOC,EAAOC,EAAYC,GAC9CC,MAAMN,EAAKC,EAAOC,EAAOC,EAAOE,GAChCE,KAAKC,YAAcJ,EAEvBL,gBACI,OAAOQ,KAAKC,YAKhBT,cACI,OACIU,KAAMZ,EAAea,GACrBC,GAAIJ,KAAKC,YACTI,KAAMd,EAAKe,4BAA4BN,KAAKO,aAC5CC,KAAMjB,EAAKe,4BAA4BN,KAAKS,WAAWC,YACvDC,KAAMX,KAAKY,UACXC,KAAMb,KAAKc,UAAUC,iBAG7BvB,KAAKwB,GACDhB,KAAKiB,WAAW,OAAQD,GAE5BxB,MAAMwB,GACFhB,KAAKiB,WAAW,QAASD,GAE7BxB,WAAWU,EAAMc,GACThB,KAAKkB,UACLlB,KAAKP,IAAI0B,UAAUjB,EAAMF,KAAOoB,IACvBA,GACDpB,KAAKqB,aAETL,EAAGI,KAIPJ","file":"../../../providers/worker/worker-file.js","sourcesContent":["define([\r\n    \"../../preload-file\",\r\n    \"./special-arg-type\",\r\n    \"./misc\"\r\n], function (PreloadFile,SpecialArgType,misc) {\r\n\r\n    /**\r\n     * Represents a remote file in a different worker/thread.\r\n     */\r\n    class WorkerFile extends PreloadFile {\r\n        constructor(_fs, _path, _flag, _stat, remoteFdId, contents) {\r\n            super(_fs, _path, _flag, _stat, contents);\r\n            this._remoteFdId = remoteFdId;\r\n        }\r\n        getRemoteFdId() {\r\n            return this._remoteFdId;\r\n        }\r\n        /**\r\n         * @hidden\r\n         */\r\n        toRemoteArg() {\r\n            return {\r\n                type: SpecialArgType.FD,\r\n                id: this._remoteFdId,\r\n                data: misc.bufferToTransferrableObject(this.getBuffer()),\r\n                stat: misc.bufferToTransferrableObject(this.getStats().toBuffer()),\r\n                path: this.getPath(),\r\n                flag: this.getFlag().getFlagString()\r\n            };\r\n        }\r\n        sync(cb) {\r\n            this._syncClose('sync', cb);\r\n        }\r\n        close(cb) {\r\n            this._syncClose('close', cb);\r\n        }\r\n        _syncClose(type, cb) {\r\n            if (this.isDirty()) {\r\n                this._fs.syncClose(type, this, (e) => {\r\n                    if (!e) {\r\n                        this.resetDirty();\r\n                    }\r\n                    cb(e);\r\n                });\r\n            }\r\n            else {\r\n                cb();\r\n            }\r\n        }\r\n    }\r\n\r\n\r\n    return WorkerFile;\r\n});"]}