{"version":3,"sources":["providers/localstorage/local-storage-provider.js"],"names":["define","Buffer","SyncKeyValueProvider","ErrorCodes","FileError","LocalStorageStore","binaryEncoding","supportsBinaryString","window","localStorage","setItem","String","fromCharCode","getItem","e","isEncoding","LocalStorageProvider","[object Object]","super","store","options","cb","Name","Options"],"mappings":";;;;;;;AAAAA,QACI,8BACA,6BACA,oBACA,mBACA,yBACD,SAAUC,EAAOC,EAAsBC,EAAWC,EAAUC,GAC3D,aASA,IAAkCC,EAA9BC,GAAuB,EAC3B,IACIC,OAAOC,aAAaC,QAAQ,WAAYC,OAAOC,aAAa,QAC5DL,EAAuBC,OAAOC,aAAaI,QAAQ,cAAgBF,OAAOC,aAAa,OAE3F,MAAOE,GAEHP,GAAuB,EAG3BD,EAAiBC,EAAuB,gBAAkB,mBACrDN,EAAOc,WAAWT,KAGnBA,EAAiB,gBAOfU,UAA6Bd,EAI/Be,cAAgBC,OAAQC,MAAO,IAAId,IAInCY,cAAcG,EAASC,GACnBA,EAAG,KAAM,IAAIL,GAEjBC,qBACI,YAAsC,IAAxBT,OAAOC,cAS7B,OALAO,EAAqBM,KAAO,eAC5BN,EAAqBO,WAErBP,EAAqBX,kBAAoBA,EAElCW","file":"../../../providers/localstorage/local-storage-provider.js","sourcesContent":["define([\n    \"skylark-langx-binary/buffer\",\n    '../sync-key-value-provider',\n    '../../error-codes',\n    '../../file-error',\n    \"./local-storage-store\"\n], function (Buffer,SyncKeyValueProvider, ErrorCodes,FileError,LocalStorageStore) {\n    'use strict';\n\n\n    /**\n     * Some versions of FF and all versions of IE do not support the full range of\n     * 16-bit numbers encoded as characters, as they enforce UTF-16 restrictions.\n     * @url http://stackoverflow.com/questions/11170716/are-there-any-characters-that-are-not-allowed-in-localstorage/11173673#11173673\n     * @hidden\n     */\n    let supportsBinaryString = false, binaryEncoding;\n    try {\n        window.localStorage.setItem(\"__test__\", String.fromCharCode(0xD800));\n        supportsBinaryString = window.localStorage.getItem(\"__test__\") === String.fromCharCode(0xD800);\n    }\n    catch (e) {\n        // IE throws an exception.\n        supportsBinaryString = false;\n    }\n    \n    binaryEncoding = supportsBinaryString ? 'binary_string' : 'binary_string_ie';\n    if (!Buffer.isEncoding(binaryEncoding)) {\n        // Fallback for non BrowserFS implementations of buffer that lack a\n        // binary_string format.\n        binaryEncoding = \"base64\";\n    }\n\n    /**\n     * A synchronous file system backed by localStorage. Connects our\n     * LocalStorageStore to our SyncKeyValueProvider.\n     */\n    class LocalStorageProvider extends SyncKeyValueProvider {\n        /**\n         * Creates a new LocalStorage file system using the contents of `localStorage`.\n         */\n        constructor() { super({ store: new LocalStorageStore() }); }\n        /**\n         * Creates a LocalStorageProvider instance.\n         */\n        static Create(options, cb) {\n            cb(null, new LocalStorageProvider());\n        }\n        static isAvailable() {\n            return typeof window.localStorage !== 'undefined';\n        }\n    }\n\n    LocalStorageProvider.Name = \"LocalStorage\";\n    LocalStorageProvider.Options = {};\n    \n    LocalStorageProvider.LocalStorageStore = LocalStorageStore;\n\n    return LocalStorageProvider;\n});"]}