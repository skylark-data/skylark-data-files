/**
 * skylark-data-files - The skylark file system library
 * @author Hudaokeji Co.,Ltd
 * @version v0.9.0
 * @link www.skylarkjs.org
 * @license MIT
 */
define(["skylark-langx-binary/buffer","skylark-langx-paths/path","../files","../error-codes","../file-error","../action-type","../file-flag","../utils"],function(n,t,e,r,i,c,s){"use strict";const{fail:o}=s;return class{supportsLinks(){return!1}diskSpace(n,t){t(0,0)}openFile(n,t,i){throw new r(e.ENOTSUP)}createFile(n,t,i,c){throw new r(e.ENOTSUP)}open(n,c,s,l){this.stat(n,!1,(a,S)=>{if(a)switch(c.pathNotExistsAction()){case i.CREATE_FILE:return this.stat(t.dirname(n),!1,(e,i)=>{e?l(e):i&&!i.isDirectory()?l(r.ENOTDIR(t.dirname(n))):this.createFile(n,c,s,l)});case i.THROW_EXCEPTION:return l(r.ENOENT(n));default:return l(new r(e.EINVAL,"Invalid FileFlag object."))}else{if(S&&S.isDirectory())return l(r.EISDIR(n));switch(c.pathExistsAction()){case i.THROW_EXCEPTION:return l(r.EEXIST(n));case i.TRUNCATE_FILE:return this.openFile(n,c,(n,t)=>{n?l(n):t?t.truncate(0,()=>{t.sync(()=>{l(null,t)})}):o()});case i.NOP:return this.openFile(n,c,l);default:return l(new r(e.EINVAL,"Invalid FileFlag object."))}}})}rename(n,t,i){i(new r(e.ENOTSUP))}renameSync(n,t){throw new r(e.ENOTSUP)}stat(n,t,i){i(new r(e.ENOTSUP))}statSync(n,t){throw new r(e.ENOTSUP)}openFileSync(n,t,i){throw new r(e.ENOTSUP)}createFileSync(n,t,i){throw new r(e.ENOTSUP)}openSync(n,c,s){let o;try{o=this.statSync(n,!1)}catch(o){switch(c.pathNotExistsAction()){case i.CREATE_FILE:if(!this.statSync(t.dirname(n),!1).isDirectory())throw r.ENOTDIR(t.dirname(n));return this.createFileSync(n,c,s);case i.THROW_EXCEPTION:throw r.ENOENT(n);default:throw new r(e.EINVAL,"Invalid FileFlag object.")}}if(o.isDirectory())throw r.EISDIR(n);switch(c.pathExistsAction()){case i.THROW_EXCEPTION:throw r.EEXIST(n);case i.TRUNCATE_FILE:return this.unlinkSync(n),this.createFileSync(n,c,o.mode);case i.NOP:return this.openFileSync(n,c,s);default:throw new r(e.EINVAL,"Invalid FileFlag object.")}}unlink(n,t){t(new r(e.ENOTSUP))}unlinkSync(n){throw new r(e.ENOTSUP)}rmdir(n,t){t(new r(e.ENOTSUP))}rmdirSync(n){throw new r(e.ENOTSUP)}mkdir(n,t,i){i(new r(e.ENOTSUP))}mkdirSync(n,t){throw new r(e.ENOTSUP)}readdir(n,t){t(new r(e.ENOTSUP))}readdirSync(n){throw new r(e.ENOTSUP)}exists(n,t){this.stat(n,null,function(n){t(!n)})}existsSync(n){try{return this.statSync(n,!0),!0}catch(n){return!1}}realpath(n,e,i){if(this.supportsLinks()){const e=n.split(t.sep);for(let n=0;n<e.length;n++){const r=e.slice(0,n+1);e[n]=t.join.apply(null,r)}}else this.exists(n,function(t){t?i(null,n):i(r.ENOENT(n))})}realpathSync(n,e){if(this.supportsLinks()){const e=n.split(t.sep);for(let n=0;n<e.length;n++){const r=e.slice(0,n+1);e[n]=t.join.apply(t,r)}return e.join(t.sep)}if(this.existsSync(n))return n;throw r.ENOENT(n)}truncate(n,t,e){this.open(n,c.getFileFlag("r+"),420,function(n,r){if(n)return e(n);r.truncate(t,function(n){r.close(function(t){e(n||t)})})})}truncateSync(n,t){const e=this.openSync(n,c.getFileFlag("r+"),420);try{e.truncateSync(t)}catch(n){throw n}finally{e.closeSync()}}readFile(n,t,e,r){const i=r;this.open(n,e,420,(n,e)=>{if(n)return r(n);r=function(n,t){e.close(function(e){return n||(n=e),i(n,t)})},e.stat((n,i)=>{if(n)return r(n);const c=Buffer.alloc(i.size);e.read(c,0,i.size,0,n=>{if(n)return r(n);if(null===t)return r(n,c);try{r(null,c.toString(t))}catch(n){r(n)}})})})}readFileSync(n,t,e){const r=this.openSync(n,e,420);try{const n=r.statSync(),e=Buffer.alloc(n.size);return r.readSync(e,0,n.size,0),r.closeSync(),null===t?e:e.toString(t)}finally{r.closeSync()}}writeFile(n,t,e,r,i,c){const s=c;this.open(n,r,420,function(n,r){if(n)return c(n);c=function(n){r.close(function(t){s(n||t)})};try{"string"==typeof t&&(t=Buffer.from(t,e))}catch(n){return c(n)}r.write(t,0,t.length,0,c)})}writeFileSync(n,t,e,r,i){const c=this.openSync(n,r,i);try{"string"==typeof t&&(t=Buffer.from(t,e)),c.writeSync(t,0,t.length,0)}finally{c.closeSync()}}appendFile(n,t,e,r,i,c){const s=c;this.open(n,r,i,function(n,r){if(n)return c(n);c=function(n){r.close(function(t){s(n||t)})},"string"==typeof t&&(t=Buffer.from(t,e)),r.write(t,0,t.length,null,c)})}appendFileSync(n,t,e,r,i){const c=this.openSync(n,r,i);try{"string"==typeof t&&(t=Buffer.from(t,e)),c.writeSync(t,0,t.length,null)}finally{c.closeSync()}}chmod(n,t,i,c){c(new r(e.ENOTSUP))}chmodSync(n,t,i){throw new r(e.ENOTSUP)}chown(n,t,i,c,s){s(new r(e.ENOTSUP))}chownSync(n,t,i,c){throw new r(e.ENOTSUP)}utimes(n,t,i,c){c(new r(e.ENOTSUP))}utimesSync(n,t,i){throw new r(e.ENOTSUP)}link(n,t,i){i(new r(e.ENOTSUP))}linkSync(n,t){throw new r(e.ENOTSUP)}symlink(n,t,i,c){c(new r(e.ENOTSUP))}symlinkSync(n,t,i){throw new r(e.ENOTSUP)}readlink(n,t){t(new r(e.ENOTSUP))}readlinkSync(n){throw new r(e.ENOTSUP)}}});
//# sourceMappingURL=../sourcemaps/providers/base-provider.js.map
